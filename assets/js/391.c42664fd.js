(window.webpackJsonp=window.webpackJsonp||[]).push([[391],{1362:function(e,t,i){"use strict";i.r(t);var o=i(42),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"multicopter-setpoint-tuning-trajectory-generator"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#multicopter-setpoint-tuning-trajectory-generator"}},[e._v("#")]),e._v(" Multicopter Setpoint Tuning (Trajectory Generator)")]),e._v(" "),i("p",[e._v("This document provides an overview of the multicopter tuning parameters that change the "),i("em",[e._v("user experience")]),e._v(": how fast the vehicle reacts to stick movements or direction changes in missions, the maximum allowed velocity, etc.")]),e._v(" "),i("p",[e._v("In other words, this topic explains how to tune the parameters that affect the value of a "),i("em",[e._v("desired setpoint")]),e._v(" rather than those that affect how well the vehicle "),i("em",[e._v("tracks")]),e._v(" the setpoint).")]),e._v(" "),i("p",[e._v('The algorithm that generates those setpoints is called a "trajectory generator".')]),e._v(" "),i("blockquote",[i("p",[i("strong",[e._v("Warning")]),e._v(" This guide is for advanced users/experts.")])]),e._v(" "),i("p",[i("span")]),e._v(" "),i("blockquote",[i("p",[i("strong",[e._v("Tip")]),e._v(" Follow the instructions in the "),i("RouterLink",{attrs:{to:"/en/config_mc/pid_tuning_guide_multicopter.html"}},[e._v("Multicopter PID Tuning Guide")]),e._v(" "),i("em",[e._v("before")]),e._v(" doing any of the tuning described here.\nDo not use these tuning parameters to fix bad tracking or vibration!")],1)]),e._v(" "),i("h2",{attrs:{id:"overview"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),i("p",[e._v("The input to the P/PID controller is a "),i("em",[e._v("desired setpoint")]),e._v(" that the vehicle should attempt to track.\n"),i("RouterLink",{attrs:{to:"/en/config_mc/pid_tuning_guide_multicopter.html"}},[e._v("PID Tuning")]),e._v(' ("Lower level tuning") aims to reduce the error between the desired setpoint and the estimate of the vehicle state.')],1),e._v(" "),i("p",[e._v("The "),i("em",[e._v("desired setpoint")]),e._v(" passed to the P/PID controller is itself calculated from a "),i("em",[e._v("demanded setpoint")]),e._v(' based on a stick position (in RC modes) or from a mission command.\nThe demanded setpoint can change very quickly (e.g. if a user moves stick from zero to maximum value as a "step").\nVehicle flight characteristics are better if the corresponding desired setpoint changes as a "ramp".')]),e._v(" "),i("p",[i("em",[e._v("Setpoint value tuning")]),e._v(' ("higher level tuning") is used to specify the mapping between the '),i("em",[e._v("demanded")]),e._v(" and the "),i("em",[e._v("desired")]),e._v(' setpoints - i.e. defining the "ramp" at which the desired setpoint follows the demanded setpoint.')]),e._v(" "),i("blockquote",[i("p",[i("strong",[e._v("Tip")]),e._v(" Poorly tuned "),i("RouterLink",{attrs:{to:"/en/config_mc/pid_tuning_guide_multicopter.html"}},[e._v("P/PID Gains")]),e._v(" can lead to instability.\nPoorly tuned "),i("em",[e._v("setpoint values")]),e._v(" cannot result in instability, but may result in either very jerky or very unresponsive reactions to setpoint changes.")],1)]),e._v(" "),i("h2",{attrs:{id:"flight-modes-trajectory-support-modes"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#flight-modes-trajectory-support-modes"}},[e._v("#")]),e._v(" Flight Modes Trajectory Support {#modes}")]),e._v(" "),i("p",[i("RouterLink",{attrs:{to:"/en/flight_modes/mission.html"}},[e._v("Mission mode")]),e._v(" used the "),i("RouterLink",{attrs:{to:"/en/config_mc/mc_jerk_limited_type_trajectory.html"}},[e._v("Jerk-limited")]),e._v(" trajectory all the time.")],1),e._v(" "),i("p",[i("RouterLink",{attrs:{to:"/en/flight_modes/position_mc.html"}},[e._v("Position mode")]),e._v(" supports all the "),i("a",{attrs:{href:"#trajectory_implementation"}},[e._v("trajectory types")]),e._v(" listed below.\nIt uses the "),i("RouterLink",{attrs:{to:"/en/config_mc/mc_jerk_limited_type_trajectory.html"}},[e._v("Jerk-limited")]),e._v(" trajectory by default; the other types can be set using "),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#MPC_POS_MODE"}},[e._v("MPC_POS_MODE")]),e._v(".")],1),e._v(" "),i("p",[i("RouterLink",{attrs:{to:"/en/flight_modes/altitude_mc.html"}},[e._v("Altitude mode")]),e._v(" similarly uses the "),i("a",{attrs:{href:"#trajectory_implementation"}},[e._v("trajectory types")]),e._v(" selected by "),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#MPC_POS_MODE"}},[e._v("MPC_POS_MODE")]),e._v(", but "),i("em",[e._v("only")]),e._v(" for smoothing the vertical component (i.e. when controlling the altitude).")],1),e._v(" "),i("p",[e._v("No other modes support trajectory tuning.")]),e._v(" "),i("h2",{attrs:{id:"trajectory-implementations-trajectory-implementation"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#trajectory-implementations-trajectory-implementation"}},[e._v("#")]),e._v(" Trajectory Implementations {#trajectory_implementation}")]),e._v(" "),i("p",[e._v("The following list provides an "),i("em",[e._v("overview")]),e._v(" of the different trajectory implementations:")]),e._v(" "),i("ul",[i("li",[i("RouterLink",{attrs:{to:"/en/config_mc/mc_jerk_limited_type_trajectory.html"}},[e._v("Jerk-limited")]),e._v(" (Default)\n"),i("ul",[i("li",[e._v("Used when smooth motion is required (e.g.: filming, mapping, cargo).")]),e._v(" "),i("li",[e._v("Generates symmetric smooth S-curves where the jerk and acceleration limits are always guaranteed.")]),e._v(" "),i("li",[e._v("May not be suitable for vehicles/use-cases that require a faster response - e.g. racer quads.")]),e._v(" "),i("li",[e._v("Set in position mode using "),i("code",[e._v("MPC_POS_MODE=3")]),e._v(".")])])],1),e._v(" "),i("li",[i("RouterLink",{attrs:{to:"/en/config_mc/mc_slew_rate_type_trajectory.html"}},[e._v("Slew-rate")]),e._v(" "),i("ul",[i("li",[e._v("Used when quick response is more important than smooth motion (e.g.: aggressive flight with position hold).")]),e._v(" "),i("li",[e._v("This is a simple implementation where the jerk and acceleration is limited using slew-rates.")]),e._v(" "),i("li",[e._v("It allows asymmetric profiles based on user intention (smooth acceleration and quick stop).")]),e._v(" "),i("li",[e._v("The jerk and acceleration limits are not hard constraints.")]),e._v(" "),i("li",[e._v("Set in position mode using "),i("code",[e._v("MPC_POS_MODE=1")]),e._v(".")])])],1),e._v(" "),i("li",[i("strong",[e._v("Simple position control")]),e._v(" "),i("ul",[i("li",[e._v("Sticks map directly to velocity setpoints without smoothing.")]),e._v(" "),i("li",[e._v("Useful for velocity control tuning.")]),e._v(" "),i("li",[e._v("Set in position mode using "),i("code",[e._v("MPC_POS_MODE=0")]),e._v(".")])])])])])}),[],!1,null,null,null);t.default=r.exports}}]);